; ===========================================
; PHP Configuration for Long-Running Services
; ===========================================

[PHP]
; ----------------------------------------
; Error Handling
; ----------------------------------------
error_reporting = E_ALL
display_errors = On
display_startup_errors = On
log_errors = On
error_log = /var/log/apache2/php_errors.log

; ----------------------------------------
; Execution Timeouts (Extended for big services)
; ----------------------------------------
max_execution_time = 600          ; 10 minutes (default: 30 seconds)
max_input_time = 600              ; 10 minutes for parsing input
default_socket_timeout = 600      ; Socket timeout

; ----------------------------------------
; Memory Limits
; ----------------------------------------
memory_limit = 512M               ; Increased memory limit

; ----------------------------------------
; File Uploads
; ----------------------------------------
file_uploads = On
upload_max_filesize = 256M        ; Large file uploads
max_file_uploads = 50             ; Number of files per request
post_max_size = 512M              ; POST data limit

; ----------------------------------------
; Data Handling
; ----------------------------------------
max_input_vars = 10000            ; Form fields limit
max_input_nesting_level = 128     ; Array nesting depth

; ----------------------------------------
; Session Configuration
; ----------------------------------------
session.gc_maxlifetime = 86400    ; Session lifetime (24 hours)
session.cookie_lifetime = 0       ; Until browser closes
session.use_strict_mode = 1       ; Security
session.cookie_httponly = 1       ; Security
session.cookie_samesite = Lax     ; CSRF protection

; ----------------------------------------
; Date & Time
; ----------------------------------------
date.timezone = Asia/Jakarta      ; Adjust to your timezone

; ----------------------------------------
; OPcache Settings (Performance)
; Development mode: validate_timestamps = 1 for live reload
; ----------------------------------------
[opcache]
opcache.enable = 1
opcache.enable_cli = 1
opcache.memory_consumption = 256
opcache.interned_strings_buffer = 16
opcache.max_accelerated_files = 20000
opcache.validate_timestamps = 1    ; Enable for development (checks file changes)
opcache.revalidate_freq = 0        ; 0 = check on every request (best for live coding)
opcache.save_comments = 1
opcache.fast_shutdown = 1

; ----------------------------------------
; APCu Cache Settings
; ----------------------------------------
[apcu]
apc.enabled = 1
apc.shm_size = 64M
apc.ttl = 7200
apc.enable_cli = 1

; ----------------------------------------
; MySQLi Settings
; ----------------------------------------
[mysqli]
mysqli.max_persistent = -1
mysqli.allow_persistent = On
mysqli.default_socket = /var/run/mysqld/mysqld.sock
mysqli.reconnect = On

; ----------------------------------------
; PDO MySQL Settings
; ----------------------------------------
[pdo_mysql]
pdo_mysql.default_socket = /var/run/mysqld/mysqld.sock

; ----------------------------------------
; cURL Settings
; ----------------------------------------
[curl]
curl.cainfo = /etc/ssl/certs/ca-certificates.crt

; ----------------------------------------
; Mail Settings
; ----------------------------------------
[mail function]
sendmail_path = /usr/sbin/sendmail -t -i
mail.add_x_header = Off

